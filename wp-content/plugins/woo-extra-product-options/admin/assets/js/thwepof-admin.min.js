function thwepofCloseModal(elm){thwepof_base.form_wizard_close(elm)}function thwepofWizardNext(elm){thwepof_base.form_wizard_next(elm)}function thwepofWizardPrevious(elm){thwepof_base.form_wizard_previous(elm)}function thwepofRuleOperandTypeChangeListner(elm){thwepof_conditions.rule_operand_type_change_listner(elm)}function thwepofAddNewConditionRow(elm,op){thwepof_conditions.add_new_rule_row(elm,op)}function thwepofRemoveRuleRow(elm){thwepof_conditions.remove_rule_row(elm)}function thwepofOpenNewFieldForm(sectionName){thwepof_settings_field.open_new_field_form(sectionName)}function thwepofOpenEditFieldForm(elm,rowId){thwepof_settings_field.open_edit_field_form(elm,rowId)}function thwepofOpenCopyFieldForm(elm,rowId){thwepof_settings_field.open_copy_field_form(elm,rowId)}function thwepofFieldTypeChangeListner(elm){thwepof_settings_field.field_type_change_listner(elm)}function thwepofSaveField(elm){thwepof_settings_field.save_field(elm)}function thwepofOpenNewSectionForm(){thwepof_settings_section.open_new_section_form()}function thwepofOpenEditSectionForm(section){thwepof_settings_section.open_edit_section_form(section)}function thwepofOpenCopySectionForm(section){thwepof_settings_section.open_copy_section_form(section)}function thwepofSaveSection(elm){thwepof_settings_section.save_section(elm)}function thwepofRemoveSection(elm){thwepof_settings_section.remove_section(elm)}function thwepofSelectAllProductFields(elm){thwepof_settings.select_all_fields(elm)}function thwepofRemoveSelectedFields(){thwepof_settings.remove_selected_fields()}function thwepofEnableSelectedFields(){thwepof_settings.enable_disable_selected_fields(1)}function thwepofDisableSelectedFields(){thwepof_settings.enable_disable_selected_fields(0)}function thwepofwidgetPopUp(){thwepof_settings.thwepofwidgetPopUp()}function thwepofwidgetClose(){thwepof_settings.thwepofwidgetClose()}var thwepof_base=function($,window,document){"use strict";function escapeHTML(html){var fn=function(tag){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;"}[tag]||tag};return html.replace(/[&<>"]/g,fn)}function decodeHtml(str){if(str&&"string"==typeof str){var map={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#039;":"'"};return str.replace(/&amp;|&lt;|&gt;|&quot;|&#039;/g,function(m){return map[m]})}return str}function isHtmlIdValid(id){return/^[a-z\_]+[a-z0-9\_]*$/.test(id.trim())}function isValidHexColor(value){return!!preg_match("/^#[a-f0-9]{6}$/i",value)}function setup_tiptip_tooltips(){var tiptip_args={attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200};$(".tips").tipTip(tiptip_args)}function setup_color_picker(form){form.find(".thpladmin-colorpick").iris({change:function(event,ui){$(this).parent().find(".thpladmin-colorpickpreview").css({backgroundColor:ui.color.toString()})},hide:!0,border:!0}).click(function(){$(".iris-picker").hide(),$(this).closest("td").find(".iris-picker").show()}),$("body").click(function(){$(".iris-picker").hide()}),$(".thpladmin-colorpick").click(function(event){event.stopPropagation()})}function setup_color_pick_preview(form){form.find(".thpladmin-colorpick").each(function(){$(this).parent().find(".thpladmin-colorpickpreview").css({backgroundColor:this.value})})}function setup_enhanced_multi_select(parent){parent.find("select.thwepof-enhanced-multi-select").each(function(){$(this).hasClass("enhanced")||$(this).selectWoo({allowClear:!0,placeholder:$(this).data("placeholder")}).addClass("enhanced")})}function setup_product_dropdown(parent,set_dv){parent.find("select.thwepof-product-select").each(function(){if(!$(this).hasClass("enhanced")){set_dv&&prepare_selected_options($(this));$(this).selectWoo({allowClear:!0,placeholder:$(this).data("placeholder"),ajax:{type:"POST",url:ajaxurl,dataType:"json",data:function(params){return{action:"thwepof_load_products",security:thwepof_admin_var.load_product_nonce,term:params.term||"",page:params.page||1}},processResults:function(result,params){return result.data},cache:!0}}).addClass("enhanced")}})}function prepare_selected_options(elm){var value=elm.siblings("input[name=i_rule_value_hidden]").val();if(value){var data={action:"thwepof_load_products",value:value,security:thwepof_admin_var.load_product_nonce};$.ajax({type:"POST",url:ajaxurl,data:data,success:function(result){$.each(result.data.results,function(key,value){var newOption=new Option(value.text,value.id,!0,!0);elm.append(newOption)})}}),elm.trigger("change")}}function prepare_field_order_indexes(elm){$(elm+" tbody tr").each(function(index,el){$("input.f_order",el).val(parseInt($(el).index(elm+" tbody tr")))})}function setup_sortable_table(parent,elm,left){parent.find(elm+" tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td.sort",scrollSensitivity:40,helper:function(e,ui){return ui.children().each(function(){$(this).width($(this).width())}),ui.css("left",left),ui}}),$(elm+" tbody").on("sortstart",function(event,ui){ui.item.css("background-color","#f6f6f6")}),$(elm+" tbody").on("sortstop",function(event,ui){ui.item.removeAttr("style"),prepare_field_order_indexes(elm)})}function get_property_field_value(form,type,name){var value="";switch(type){case"select":value=form.find("select[name=i_"+name+"]").val(),value=null==value?"":value;break;case"checkbox":value=form.find("input[name=i_"+name+"]").prop("checked"),value=value?1:0;break;case"textarea":value=form.find("textarea[name=i_"+name+"]").val(),value=null==value?"":value;break;default:value=form.find("input[name=i_"+name+"]").val(),value=null==value?"":value}return value}function set_property_field_value(form,type,name,value,multiple){switch(type){case"select":1==multiple&&"string"==typeof value&&(value=value.split(","),name+="[]"),form.find('select[name="i_'+name+'"]').val(value);break;case"checkbox":value=1==value,form.find("input[name=i_"+name+"]").prop("checked",value);break;case"textarea":value=value?decodeHtml(value):value,form.find("textarea[name=i_"+name+"]").val(value);break;case"colorpicker":var bg_color=value?{backgroundColor:value}:{backgroundColor:""};form.find("input[name=i_"+name+"]").val(value),form.find("."+name+"_preview").css(bg_color);break;default:value=value?decodeHtml(value):value,form.find("input[name=i_"+name+"]").val(value)}}function setup_form_wizard(){$(".pp_nav_links > li").click(function(){var index=$(this).data("index");open_tab($(this).closest(".thpladmin-modal-mask"),$(this),index)})}function get_popup(elm){return $(elm).closest(".thpladmin-modal-mask")}function get_active_tab(popup){return popup.find("ul.pp_nav_links").find("li.active")}function get_next_tab_index(elm){var popup=get_popup(elm),active=get_active_tab(popup),link=active.nextAll("li").not(".disabled").first();return link.length?link.data("index"):active_tab}function get_prev_tab_index(elm){var popup=get_popup(elm),active=get_active_tab(popup),link=active.prevAll("li").not(".disabled").first();return link.length?link.data("index"):active_tab}function form_wizard_open(popup){active_tab=0,popup.find("ul.pp_nav_links li").first().click(),popup.css("display","block")}function form_wizard_close(elm){get_popup(elm).css("display","none"),active_tab=0}function form_wizard_next(elm){active_tab=get_next_tab_index(elm),move_to(elm,active_tab)}function form_wizard_previous(elm){active_tab=get_prev_tab_index(elm),move_to(elm,active_tab)}function form_wizard_start(elm){active_tab=0,move_to(elm,active_tab)}function move_to(elm,index){var popup=get_popup(elm);open_tab(popup,popup.find('*[data-index="'+index+'"]'),index)}function open_tab(popup,link,index){var panel=popup.find(".data_panel_"+index);close_all_data_panel(popup),link.addClass("active"),panel.css("display","block"),enable_disable_btns(popup,link)}function close_all_data_panel(popup){popup.find(".pp_nav_links > li").removeClass("active"),popup.find(".data-panel").css("display","none")}function enable_disable_tab(popup,index,disable){var link=popup.find('*[data-index="'+index+'"]'),panel=popup.find(".data_panel_"+index);disable?(link.addClass("disabled"),panel.find(":input").attr("disabled",!0)):(link.removeClass("disabled"),panel.find(":input").attr("disabled",!1))}function form_wizard_enable_tab(popup,index){enable_disable_tab(popup,index,0)}function form_wizard_disable_tab(popup,index){enable_disable_tab(popup,index,1)}function form_wizard_enable_all_tabs(popup){popup.find(".pp_nav_links > li").removeClass("disabled")}function enable_disable_btns(popup,link){var nextBtn=popup.find(".next-btn"),prevBtn=popup.find(".prev-btn");link.hasClass("first")?(nextBtn.prop("disabled",!1),prevBtn.prop("disabled",!0)):link.hasClass("last")?(nextBtn.prop("disabled",!0),prevBtn.prop("disabled",!1)):(nextBtn.prop("disabled",!1),prevBtn.prop("disabled",!1))}function block_enter_key_submission(popup){popup.find("input").off("keypress").on("keypress",function(e){return 13!==e.which})}var active_tab=0;return{escapeHTML:escapeHTML,decodeHtml:decodeHtml,isHtmlIdValid:isHtmlIdValid,isValidHexColor:isValidHexColor,block_enter_key_submission:block_enter_key_submission,setup_tiptip_tooltips:setup_tiptip_tooltips,setup_color_picker:setup_color_picker,setup_color_pick_preview:setup_color_pick_preview,setup_enhanced_multi_select:setup_enhanced_multi_select,setup_product_dropdown:setup_product_dropdown,setup_sortable_table:setup_sortable_table,get_property_field_value:get_property_field_value,set_property_field_value:set_property_field_value,setup_form_wizard:setup_form_wizard,form_wizard_open:form_wizard_open,form_wizard_close:form_wizard_close,form_wizard_next:form_wizard_next,form_wizard_previous:form_wizard_previous,form_wizard_start:form_wizard_start,form_wizard_enable_tab:form_wizard_enable_tab,form_wizard_disable_tab:form_wizard_disable_tab,form_wizard_enable_all_tabs:form_wizard_enable_all_tabs}}(window.jQuery,window,document),thwepof_conditions=function($,window,document){"use strict";function rule_operand_type_change_listner(elm){$(elm).closest("tr.thwepo_condition").find("td.thwepo_condition_value").html();var subject=$(elm).val(),condition_row=$(elm).closest("tr.thwepo_condition"),target=condition_row.find("td.thwepo_condition_value");"category"===subject?target.html($("#thwepo_product_cat_select").html()):"tag"===subject?target.html($("#thwepo_product_tag_select").html()):target.html($("#thwepo_product_select").html()),thwepof_base.setup_enhanced_multi_select(condition_row),thwepof_base.setup_product_dropdown(condition_row,!1)}function add_new_rule_row(elm,op){var condition_row=$(elm).closest("tr"),condition={};if(condition.subject=condition_row.find("select[name=i_rule_subject]").val(),condition.comparison=condition_row.find("select[name=i_rule_comparison]").val(),condition.cvalue=condition_row.find("select[name=i_rule_value]").val(),!is_valid_condition(condition))return void alert("Please provide a valid condition.");if(1==op){var conditionSetTable=$(elm).closest(".thwepo_condition_set");conditionSetTable.find("tbody tr.thwepo_condition").size()>0?($(elm).closest("td").html(OP_AND_HTML),conditionSetTable.find("tbody tr.thwepo_condition:last").after(CONDITION_HTML)):conditionSetTable.find("tbody").append(CONDITION_HTML)}else if(2==op){var ruleTable=$(elm).closest(".thwepo_rule"),ruleSize=ruleTable.find("tbody tr.thwepo_condition_set_row").size();ruleSize>0?ruleTable.find("tbody tr.thwepo_condition_set_row:last").after(CONDITION_SET_HTML_WITH_OR):ruleTable.find("tbody").append(CONDITION_SET_HTML)}}function remove_rule_row(elm){var ctable=$(elm).closest("table.thwepo_condition_set"),rtable=$(elm).closest("table.thwepo_rule");$(elm).closest("tr.thwepo_condition").remove();var cSize=ctable.find("tbody tr.thwepo_condition").size();0==cSize&&ctable.closest("tr.thwepo_condition_set_row").remove();var rSize=rtable.find("tbody tr.thwepo_condition_set_row").size();0==cSize&&0==rSize&&rtable.find("tbody").append(CONDITION_SET_HTML)}function is_valid_condition(condition){return!(!condition.subject||!condition.comparison)}function get_conditional_rules(elm){var conditionalRules=[];$(elm).find("#thwepo_conditional_rules tbody tr.thwepo_rule_set_row").each(function(){var ruleSet=[];$(this).find("table.thwepo_rule_set tbody tr.thwepo_rule_row").each(function(){var rule=[];$(this).find("table.thwepo_rule tbody tr.thwepo_condition_set_row").each(function(){var conditions=[];$(this).find("table.thwepo_condition_set tbody tr.thwepo_condition").each(function(){var condition={};condition.subject=$(this).find("select[name=i_rule_subject]").val(),condition.comparison=$(this).find("select[name=i_rule_comparison]").val(),condition.cvalue=$(this).find("select[name=i_rule_value]").val(),is_valid_condition(condition)&&conditions.push(condition)}),conditions.length>0&&rule.push(conditions)}),rule.length>0&&ruleSet.push(rule)}),ruleSet.length>0&&conditionalRules.push(ruleSet)});var conditionalRulesJson=conditionalRules.length>0?JSON.stringify(conditionalRules):"";return conditionalRulesJson=encodeURIComponent(conditionalRulesJson)}function populate_conditional_rules(form,conditionalRulesJson){var conditionalRulesHtml="";if(conditionalRulesJson)try{conditionalRulesJson=decodeURIComponent(conditionalRulesJson);var conditionalRules=$.parseJSON(conditionalRulesJson);conditionalRules&&jQuery.each(conditionalRules,function(){var ruleSet=this,rulesHtml="";jQuery.each(ruleSet,function(){var rule=this,conditionSetsHtml="",y=0;rule.length;jQuery.each(rule,function(){var conditions=this,conditionsHtml="",x=1,size=conditions.length;jQuery.each(conditions,function(){var lastRow=x==size,conditionHtml=populate_condition_html(this,lastRow);conditionHtml&&(conditionsHtml+=conditionHtml),x++});var firstRule=0==y,conditionSetHtml=populate_condition_set_html(conditionsHtml,firstRule);conditionSetHtml&&(conditionSetsHtml+=conditionSetHtml),y++});var ruleHtml=populate_rule_html(conditionSetsHtml);ruleHtml&&(rulesHtml+=ruleHtml)});var ruleSetHtml=populate_rule_set_html(rulesHtml);ruleSetHtml&&(conditionalRulesHtml+=ruleSetHtml)})}catch(err){alert(err)}if(conditionalRulesHtml){var conditionalRulesTable=form.find("#thwepo_conditional_rules tbody");conditionalRulesTable.html(conditionalRulesHtml),thwepof_base.setup_enhanced_multi_select(conditionalRulesTable),thwepof_base.setup_product_dropdown(conditionalRulesTable,!0),conditionalRulesTable.find("tr.thwepo_condition").each(function(){var ruleVal=$(this).find("input[name=i_rule_value_hidden]").val();ruleVal=ruleVal.split(","),$(this).find("select[name=i_rule_value]").val(ruleVal).trigger("change")})}else{var conditionalRulesTable=form.find("#thwepo_conditional_rules tbody");conditionalRulesTable.html(RULE_SET_HTML),thwepof_base.setup_enhanced_multi_select(conditionalRulesTable),thwepof_base.setup_product_dropdown(conditionalRulesTable,!1)}}function populate_rule_set_html(ruleHtml){var html="";return ruleHtml&&(html+='<tr class="thwepo_rule_set_row"><td><table class="thwepo_rule_set" width="100%"><tbody>',html+=ruleHtml,html+="</tbody></table></td></tr>"),html}function populate_rule_html(conditionSetHtml){var html="";return conditionSetHtml&&(html+='<tr class="thwepo_rule_row"><td><table class="thwepo_rule" width="100%" style=""><tbody>',html+=conditionSetHtml,html+="</tbody></table></td></tr>"),html}function populate_condition_set_html(conditionsHtml,firstRule){var html="";return conditionsHtml&&(firstRule?(html+='<tr class="thwepo_condition_set_row"><td><table class="thwepo_condition_set" width="100%" style=""><tbody>',html+=conditionsHtml,html+="</tbody></table></td></tr>"):(html+='<tr class="thwepo_condition_set_row"><td><table class="thwepo_condition_set" width="100%" style=""><thead>'+OP_OR_HTML+"</thead><tbody>",html+=conditionsHtml,html+="</tbody></table></td></tr>")),html}function populate_condition_html(condition,lastRow){var html="";if(condition){var selectedSubjProd="product"===condition.subject?"selected":"",selectedSubjCat="category"===condition.subject?"selected":"",selectedSubjTag="tag"===condition.subject?"selected":"",selectedCompjE="equals"===condition.comparison?"selected":"",selectedCompjNE="not_equals"===condition.comparison?"selected":"",valueHtml='<input type="hidden" name="i_rule_value_hidden" value="'+condition.cvalue+'"/>';"product"===condition.subject?valueHtml+=$("#thwepo_product_select").html():"category"===condition.subject?valueHtml+=$("#thwepo_product_cat_select").html():"tag"===condition.subject?valueHtml+=$("#thwepo_product_tag_select").html():valueHtml+='<input type="text" name="i_rule_value" value="'+condition.cvalue+'"/>';var actionsHtml=lastRow?OP_HTML:OP_AND_HTML;html+='<tr class="thwepo_condition">',html+='<td class="operand-type"><select name="i_rule_subject" onchange="thwepofRuleOperandTypeChangeListner(this)" value="'+condition.subject+'">',html+='<option value=""></option><option value="product" '+selectedSubjProd+">"+thwepof_admin_var.product+"</option>",html+='<option value="category" '+selectedSubjCat+">"+thwepof_admin_var.category+"</option>",html+='<option value="tag" '+selectedSubjTag+">"+thwepof_admin_var.tag+"</option>",html+="</select></td>",html+='<td class="operator"><select name="i_rule_comparison" value="'+condition.comparison+'">',html+='<option value=""></option><option value="equals" '+selectedCompjE+">"+thwepof_admin_var.equal+"</option>",html+='<option value="not_equals" '+selectedCompjNE+">"+thwepof_admin_var.notequal+"</option>",html+="</select></td>",html+='<td class="operand thwepo_condition_value">'+valueHtml+"</td>",html+='<td class="actions">'+actionsHtml+"</td></tr>"}return html}var OP_AND_HTML='<label class="thwepof_logic_label">AND</label>';OP_AND_HTML+='<a href="javascript:void(0)" onclick="thwepofRemoveRuleRow(this)" class="thwepof_delete_icon dashicons dashicons-no" title="Remove"></a>';var OP_OR_HTML='<tr class="thwepo_rule_or"><td colspan="4" align="center">OR</td></tr>',OP_HTML='<a href="javascript:void(0)" class="thwepof_logic_link" onclick="thwepofAddNewConditionRow(this, 1)" title="">AND</a>';OP_HTML+='<a href="javascript:void(0)" class="thwepof_logic_link" onclick="thwepofAddNewConditionRow(this, 2)" title="">OR</a>',OP_HTML+='<a href="javascript:void(0)" onclick="thwepofRemoveRuleRow(this)" class="thwepof_delete_icon dashicons dashicons-no" title="Remove"></a>';var CONDITION_HTML='<tr class="thwepo_condition">';CONDITION_HTML+='<td class="operand-type"><select name="i_rule_subject" onchange="thwepofRuleOperandTypeChangeListner(this)">',CONDITION_HTML+='<option value=""></option><option value="product">'+thwepof_admin_var.product+"</option>",CONDITION_HTML+='<option value="category">'+thwepof_admin_var.category+"</option>",CONDITION_HTML+='<option value="tag">'+thwepof_admin_var.tag+"</option>",CONDITION_HTML+="</select></td>",CONDITION_HTML+='<td class="operator"><select name="i_rule_comparison">',CONDITION_HTML+='<option value=""></option> <option value="equals">'+thwepof_admin_var.equal+'</option><option value="not_equals">'+thwepof_admin_var.notequal+"</option>",CONDITION_HTML+="</select></td>",CONDITION_HTML+='<td class="operand thwepo_condition_value"><input type="text" name="i_rule_value" ></td>',CONDITION_HTML+='<td class="actions">'+OP_HTML+"</td></tr>";var CONDITION_SET_HTML='<tr class="thwepo_condition_set_row"><td>';CONDITION_SET_HTML+='<table class="thwepo_condition_set" width="100%" style=""><tbody>'+CONDITION_HTML+"</tbody></table>",CONDITION_SET_HTML+="</td></tr>";var CONDITION_SET_HTML_WITH_OR='<tr class="thwepo_condition_set_row"><td>';CONDITION_SET_HTML_WITH_OR+='<table class="thwepo_condition_set" width="100%" style=""><thead>'+OP_OR_HTML+"</thead><tbody>"+CONDITION_HTML+"</tbody></table>",CONDITION_SET_HTML_WITH_OR+="</td></tr>";var RULE_HTML='<tr class="thwepo_rule_row"><td>';RULE_HTML+='<table class="thwepo_rule" width="100%" style=""><tbody>'+CONDITION_SET_HTML+"</tbody></table>",RULE_HTML+="</td></tr>";var RULE_SET_HTML='<tr class="thwepo_rule_set_row"><td>';return RULE_SET_HTML+='<table class="thwepo_rule_set" width="100%"><tbody>'+RULE_HTML+"</tbody></table>",RULE_SET_HTML+="</td></tr>",{populate_conditional_rules:populate_conditional_rules,rule_operand_type_change_listner:rule_operand_type_change_listner,add_new_rule_row:add_new_rule_row,remove_rule_row:remove_rule_row,get_conditional_rules:get_conditional_rules}}(window.jQuery,window,document),thwepof_settings_field=function($,window,document){"use strict";function open_new_field_form(sname){open_field_form("new",!1)}function open_edit_field_form(elm,rowId){open_field_form("edit",elm)}function open_copy_field_form(elm,rowId){open_field_form("copy",elm)}function open_field_form(action,elm){var popup=$("#thwepof_field_form_pp"),form=$("#thwepof_field_form");populate_field_form(popup,form,action,elm),thwepof_base.form_wizard_open(popup),thwepof_base.setup_color_pick_preview(form)}function populate_field_form(popup,form,action,elm){var title="edit"===action?thwepof_admin_var.edit_field:thwepof_admin_var.new_field;popup.find(".wizard-title").text(title),form.find(".err_msgs").html(""),form.find("input[name=i_action]").val(action),form.find("input[name=i_name_old]").val(""),form.find("input[name=i_rules]").val("");var props=!1,row=!1;if("edit"===action||"copy"===action){row=$(elm).closest("tr");var props_json=row.find(".f_props").val();props=JSON.parse(props_json)}populate_field_form_general(form,action,props),form.find("select[name=i_type]").change(),populate_field_form_props(form,props),populate_display_rules(form,row)}function populate_field_form_general(form,action,props){var name="",type="inputtext";props&&("edit"===action?(name=props.name,type=props.type):"copy"===action&&(type=props.type)),thwepof_base.set_property_field_value(form,"text","name",name,0),thwepof_base.set_property_field_value(form,"hidden","name_old",name,0),thwepof_base.set_property_field_value(form,"select","type",type,0)}function populate_field_form_props(form,props){var ftype=props.type;$.each(FIELD_FORM_PROPS,function(name,field){if("name"==name||"type"==name)return!0;var type=field.type,value=field.value?field.value:"",multiple=field.multiple?field.multiple:0;props&&(value=props[name]?props[name]:""),"paragraph"==ftype&&"value"==name&&(type="textarea"),thwepof_base.set_property_field_value(form,type,name,value,multiple),"select"==type&&(name=1==multiple?name+"[]":name,1!=multiple&&1!=field.change||form.find('select[name="i_'+name+'"]').trigger("change"))})}function populate_display_rules(form,row){var rules=row.length?row.find(".f_rules").val():"";thwepof_conditions.populate_conditional_rules(form,rules,!1)}function field_type_change_listner(elm){var popup=$("#thwepof_field_form_pp"),form=$(elm).closest("form"),type=$(elm).val();type=null==type?"inputtext":type,form.find(".thwepof_field_form_tab_general_placeholder").html($("#thwepof_field_form_id_"+type).html()),thwepof_base.form_wizard_enable_all_tabs(popup),form.find(":input").attr("disabled",!1),form.find("tr").removeClass("disabled"),"hidden"!==type&&"heading"!==type&&"paragraph"!==type&&"separator"!==type||thwepof_base.form_wizard_disable_tab(popup,1),"checkbox"===type&&disable_field(form,"select","title_position"),thwepof_base.setup_enhanced_multi_select(form),thwepof_base.setup_color_picker(form),thwepof_base.block_enter_key_submission(popup)}function disable_field(form,type,name){var elm=null;switch(type){case"select":elm=form.find('select[name="i_'+name+'"]');break;case"textarea":elm=form.find("textarea[name=i_"+name+"]");break;default:elm=form.find("input[name=i_"+name+"]")}elm&&elm.length&&(elm.attr("disabled",!0),elm.closest("tr.form_field_"+name).addClass("disabled"))}function save_field(elm){var popup=$("#thwepof_field_form_pp"),form=$("#thwepof_field_form");validate_field_form(form,popup)&&(prepare_field_form(form),form.submit())}function validate_field_form(form,popup){var err_msgs="",fname=thwepof_base.get_property_field_value(form,"text","name"),ftype=thwepof_base.get_property_field_value(form,"select","type");if(""==ftype)err_msgs="Type is required";else if(""==fname)err_msgs="Name is required";else if(thwepof_base.isHtmlIdValid(fname)){if("html"==ftype)""==ftitle&&(err_msgs="Title is required");else if("paragraph"==ftype){var content=thwepof_base.get_property_field_value(form,"textarea","value");""==content&&(err_msgs="Content is required")}else if("html"==ftype){var content=thwepof_base.get_property_field_value(form,"text","title");""==content&&(err_msgs="Title is required")}}else err_msgs=MSG_INVALID_NAME;return""==err_msgs||(form.find(".err_msgs").html(err_msgs),thwepof_base.form_wizard_start(popup),!1)}function prepare_field_form(form){var rules_json=thwepof_conditions.get_conditional_rules(form);rules_json=rules_json.replace(/"/g,"'"),thwepof_base.set_property_field_value(form,"hidden","rules",rules_json,0)}var MSG_INVALID_NAME='NAME/ID must begin with a lowercase letter ([a-z]) and may be followed by any number of lowercase letters, digits ([0-9]) and underscores ("_")',FIELD_FORM_PROPS={name:{name:"name",type:"text"},type:{name:"type",type:"select"},value:{name:"value",type:"text"},options:{name:"options",type:"text"},placeholder:{name:"placeholder",type:"text"},validator:{name:"validator",type:"select"},input_class:{name:"input_class",type:"text"},cssclass:{name:"cssclass",type:"text"},maxlength:{name:"maxlength",type:"text"},minlength:{name:"minlength",type:"text"},step:{name:"step",type:"text"},title:{name:"title",type:"text"},title_type:{name:"title_type",type:"select"},title_position:{name:"title_position",type:"select",value:"left"},title_class:{name:"title_class",type:"text"},checked:{name:"checked",type:"checkbox"},required:{name:"required",type:"checkbox"},enabled:{name:"enabled",type:"checkbox",value:1},readonly:{name:"readonly",type:"checkbox"},view_password:{name:"view_password",type:"checkbox"},maxsize:{name:"maxsize",type:"text"},accept:{name:"accept",type:"text"},cols:{name:"cols",type:"text"},rows:{name:"rows",type:"text"},input_mask:{name:"input_mask",type:"text"}};return{open_new_field_form:open_new_field_form,open_edit_field_form:open_edit_field_form,open_copy_field_form:open_copy_field_form,field_type_change_listner:field_type_change_listner,save_field:save_field}}(window.jQuery,window,document),thwepof_settings_section=function($,window,document){"use strict";function open_new_section_form(){open_section_form("new",!1)}function open_edit_section_form(valueJson){open_section_form("edit",valueJson)}function open_copy_section_form(valueJson){open_section_form("copy",valueJson)}function open_section_form(type,valueJson){var popup=$("#thwepof_section_form_pp"),form=$("#thwepof_section_form");populate_section_form(popup,form,type,valueJson),thwepof_base.form_wizard_open(popup),thwepof_base.setup_color_picker(form),thwepof_base.setup_enhanced_multi_select(form),thwepof_base.block_enter_key_submission(popup)}function populate_section_form(popup,form,type,valueJson){var title="edit"===type?thwepof_admin_var.edit_section:thwepof_admin_var.new_section;if(popup.find(".wizard-title").text(title),form.find(".err_msgs").html(""),form.find("input[name=i_name]").prop("readonly",!1),form.find("input[name=s_action]").val(type),form.find("input[name=s_name]").val(""),form.find("input[name=s_name_copy]").val(""),form.find("input[name=i_position_old]").val(""),form.find("input[name=i_rules]").val(""),"new"===type)set_form_field_values(form,SECTION_FORM_FIELDS,!1);else{if(set_form_field_values(form,SECTION_FORM_FIELDS,valueJson),"copy"===type){var sNameCopy=valueJson?valueJson.name:"";form.find("input[name=i_name]").val(""),form.find("input[name=s_name_copy]").val(sNameCopy)}else form.find("input[name=i_name]").prop("readonly",!0);form.find("select[name=i_position_old]").val(valueJson.position)}}function set_form_field_values(form,fields,valuesJson){var sname=valuesJson&&valuesJson.name?valuesJson.name:"";$.each(fields,function(name,field){var type=field.type,value=valuesJson&&valuesJson[name]?valuesJson[name]:field.value,multiple=field.multiple?field.multiple:0;"checkbox"===type&&!valuesJson&&field.checked&&(value=field.checked),thwepof_base.set_property_field_value(form,type,name,value,multiple)});var prop_form=$("#section_prop_form_"+sname),rulesAction=valuesJson&&valuesJson.rules_action?valuesJson.rules_action:"show",conditionalRules=prop_form.find(".f_rules").val();thwepof_base.set_property_field_value(form,"select","rules_action",rulesAction,!1),thwepof_conditions.populate_conditional_rules(form,conditionalRules,!1)}function save_section(elm){var popup=$("#thwepof_section_form_pp"),form=$("#thwepof_section_form");validate_section(form,popup)&&(prepare_section_form(form),form.submit())}function validate_section(form,popup){var name=form.find("input[name=i_name]").val(),title=form.find("input[name=i_title]").val(),position=form.find("select[name=i_position]").val(),err_msgs="";return""==name.trim()?err_msgs="Name/ID is required":thwepof_base.isHtmlIdValid(name)?""==title.trim()?err_msgs="Title is required":""==position&&(err_msgs="Please select a position"):err_msgs=MSG_INVALID_NAME,""==err_msgs||(form.find(".err_msgs").html(err_msgs),thwepof_base.form_wizard_start(popup),!1)}function prepare_section_form(form){var rules_json=thwepof_conditions.get_conditional_rules(form);rules_json=rules_json.replace(/"/g,"'"),thwepof_base.set_property_field_value(form,"hidden","rules",rules_json,0)}function remove_section(elm){if(confirm("Are you sure you want to delete this section?.")){var form=$(elm).closest("form");form&&form.submit()}}var MSG_INVALID_NAME='NAME/ID must begin with a lowercase letter ([a-z]) and may be followed by any number of lowercase letters, digits ([0-9]) and underscores ("_")',SECTION_FORM_FIELDS={name:{name:"name",label:"Name/ID",type:"text",required:1},position:{name:"position",label:"Display Position",type:"select",value:"woo_before_add_to_cart_button",required:1},order:{name:"order",label:"Display Order",type:"text"},cssclass:{name:"cssclass",label:"CSS Class",type:"text"},show_title:{name:"show_title",label:"Show section title in product page.",type:"checkbox",value:"yes",checked:!0},title_cell_with:{name:"title_cell_with",label:"Col-1 Width",type:"text",value:""},field_cell_with:{name:"field_cell_with",label:"Col-2 Width",type:"text",value:""},title:{name:"title",label:"Title",type:"text"},title_type:{name:"title_type",label:"Title Type",type:"select",value:"h3"},title_color:{name:"title_color",label:"Title Color",type:"colorpicker"},title_class:{name:"title_class",label:"Title Class",type:"text"}};return{open_new_section_form:open_new_section_form,open_edit_section_form:open_edit_section_form,open_copy_section_form:open_copy_section_form,save_section:save_section,remove_section:remove_section}}(window.jQuery,window,document),thwepof_settings=function($,window,document){"use strict";function select_all_fields(elm){var checkAll=$(elm).prop("checked");$("#thwepof_product_fields tbody input:checkbox[name=select_field]").prop("checked",checkAll)}function remove_selected_fields(){$("#thwepof_product_fields tbody tr").removeClass("strikeout"),$("#thwepof_product_fields tbody input:checkbox[name=select_field]:checked").each(function(){var row=$(this).closest("tr");row.hasClass("strikeout")||row.addClass("strikeout"),row.find(".f_deleted").val(1),row.find(".f_edit_btn").prop("disabled",!0)})}function enable_disable_selected_fields(enabled){$("#thwepof_product_fields tbody input:checkbox[name=select_field]:checked").each(function(){var row=$(this).closest("tr");0==enabled?row.hasClass("thwepof-disabled")||row.addClass("thwepof-disabled"):row.removeClass("thwepof-disabled"),row.find(".f_edit_btn").prop("disabled",1!=enabled),row.find(".td_enabled").html(1==enabled?'<span class="dashicons dashicons-yes tips" data-tip="Yes"></span>':"-"),row.find(".f_enabled").val(enabled)})}function widgetPopUp(){var x=document.getElementById("myDIV"),th_animation=(document.getElementById("myWidget"),document.getElementById("th_quick_border_animation")),th_arrow=document.getElementById("th_arrow_head");"none"!==x.style.display&&x.style.display?(x.style.display="none",th_arrow.style="transform:rotate(45deg);",
th_animation.style.animation="pulse 1.5s infinite"):(x.style.display="block",th_arrow.style="transform:rotate(-12.5deg);",th_animation.style="box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);",th_animation.style.animation="none")}function widgetClose(){var z=document.getElementById("myDIV"),th_animation=(document.getElementById("myWidget"),document.getElementById("th_quick_border_animation")),th_arrow=document.getElementById("th_arrow_head");z.style.display="none",th_arrow.style="transform:rotate(45deg);",th_animation.style.animation="pulse 1.5s infinite"}return $(function(){var settings_form=$("#thwepof_product_fields_form");thwepof_base.setup_sortable_table(settings_form,"#thwepof_product_fields","0"),thwepof_base.setup_tiptip_tooltips(),thwepof_base.setup_form_wizard()}),$(document).ready(function(){setTimeout(function(){$("#thwepof_review_request_notice").fadeIn(500)},2e3)}),{thwepofwidgetPopUp:widgetPopUp,thwepofwidgetClose:widgetClose,select_all_fields:select_all_fields,remove_selected_fields:remove_selected_fields,enable_disable_selected_fields:enable_disable_selected_fields}}(window.jQuery,window,document);